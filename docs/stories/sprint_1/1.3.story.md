# História 1.3: Criação e Gestão de Projetos pelo Gerente de Projeto

**Status:** Pronto para Desenvolvimento

**Objetivo:** Capacitar Gerentes de Projeto para criar e gerenciar projetos, organizando o trabalho da equipe em espaços dedicados.

**Contexto:** Esta história empodera os Gerentes de Projeto, dando-lhes a autonomia para estruturar o trabalho e fornecer transparência sobre o status das tarefas, um dos objetivos centrais do TaskFlow.

**Padrões:**
*   **Backend:** Autorização baseada em papéis com `@PreAuthorize` para garantir que apenas `PROJECT_MANAGER` ou `ADMIN` possam gerenciar projetos.
*   **Frontend:** Roteamento protegido para as páginas de gerenciamento de projetos.
*   **Dados:** Novas entidades `Project` e `ProjectMember` para armazenar informações do projeto e associações de equipe.

**Declaração da História:** Como Gerente de Projeto, quero criar e gerenciar projetos, para que eu possa organizar o trabalho da minha equipe e ter um espaço dedicado para minhas tarefas.

**Critérios de Aceitação:**
1.  O Gerente de Projeto deve poder criar novos projetos com nome e descrição.
2.  O criador do projeto é automaticamente definido como seu `owner`.
3.  O Gerente de Projeto deve poder editar e deletar os projetos que gerencia.
4.  O sistema deve registrar todas as operações de CRUD de projetos no histórico de atividades.
5.  O comportamento da API/lógica de backend pode ser verificado localmente.

**Notas de Desenvolvimento:**

*   **Insights da História Anterior**: Depende da história 1.2, que permite a atribuição do papel de 'Gerente de Projeto'.
*   **Modelos de Dados**:
    *   Criação das entidades `Project` e `ProjectMember`.
        *   [Fonte: architecture/5-modelagem-de-dados.md]
*   **Especificações da API**:
    *   Endpoints CRUD para `/api/v1/projects`.
    *   Endpoints protegidos para acesso de `PROJECT_MANAGER` (proprietário) ou `ADMIN`.
        *   [Fonte: architecture/8-especificao-da-api-restful.md#8.2-projetos-projects]
*   **Localização de Arquivos**:
    *   **Backend**: `taskflow-backend/src/main/java/com/taskflow/project/`
    *   **Frontend**: `taskflow-frontend/src/features/projects/`
        *   [Fonte: architecture/4-estrutura-unificada-do-projeto-polyrepo.md]
*   **Restrições Técnicas**:
    *   Uso de `@PreAuthorize` no backend para controle de acesso.

**Tarefas / Subtarefas:**

1.  **Backend**
    *   [x] Implementar `ProjectController` com endpoints CRUD para projetos.
    *   [x] Implementar `ProjectService` para a lógica de negócio.
    *   [x] Proteger os endpoints com `@PreAuthorize`.
    *   [x] Escrever testes unitários e de integração.
2.  **Frontend**
    *   Criar a página `ProjectListPage`.
    *   Criar o formulário `ProjectForm`.
    *   Implementar `projectService` para as chamadas de API.
    *   Proteger as rotas de projeto.
    *   Escrever testes de componentes.

**Change Log:**
- 2025-11-06: Implementação inicial do backend para gerenciamento de projetos (CRUD, segurança, testes).

**File List:**
- taskflow-backend/src/main/java/com/taskflow/project/Project.java (modificado)
- taskflow-backend/src/main/java/com/taskflow/project/ProjectRepository.java
- taskflow-backend/src/main/java/com/taskflow/project/ProjectService.java
- taskflow-backend/src/main/java/com/taskflow/project/dto/ProjectRequest.java
- taskflow-backend/src/main/java/com/taskflow/project/dto/ProjectResponse.java
- taskflow-backend/src/main/java/com/taskflow/project/ProjectController.java
- taskflow-backend/src/test/java/com/taskflow/project/ProjectServiceTest.java
- taskflow-backend/src/test/java/com/taskflow/project/ProjectControllerIntegrationTest.java

## QA Results

### Review Date: 2025-11-06

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

O backend para gerenciamento de projetos foi implementado e segue os padrões de arquitetura. O frontend foi implementado, mas continua a desviar da arquitetura SPA com React, o que introduz débito técnico.

### Refactoring Performed

Nenhum refactoring foi realizado.

### Compliance Check

- Coding Standards: [✓] Backend atende aos padrões. O frontend tem desvios.
- Project Structure: [✓] Backend atende à estrutura. O frontend tem desvios.
- Testing Strategy: [✗] Faltam testes de frontend e o teste para o histórico de atividades (AC 4).
- All ACs Met: [✗] O AC 4 não foi atendido.

### Improvements Checklist

- [ ] **Segurança:** Mover o armazenamento de token JWT de `localStorage` para cookies HttpOnly.
- [ ] **Testes:** Adicionar um teste para a funcionalidade de histórico de atividades (AC 4).
- [ ] **Testes:** Adicionar testes de frontend para o fluxo de gerenciamento de projetos.
- [ ] **Arquitetura:** Planejar uma migração gradual do frontend para a arquitetura SPA com React.

### Security Review

- **CONCERNS:** O token JWT é armazenado no `localStorage`, o que é vulnerável a ataques XSS.

### Performance Considerations

Nenhuma preocupação de performance no momento.

### Files Modified During Review

Nenhum arquivo foi modificado.

### Gate Status

Gate: CONCERNS → docs/qa/gates/1.3-project-management.yml

### Recommended Status

[✓ Ready for Done, with concerns noted]
