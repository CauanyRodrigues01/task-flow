# História 1.4: Gestão de Equipes de Projeto pelo Gerente de Projeto

**Status:** Ready for Review

**Objetivo:** Permitir que Gerentes de Projeto montem e gerenciem as equipes de seus projetos, adicionando e removendo Colaboradores.

**Contexto:** Esta história é uma continuação direta da 1.3 (Criação de Projetos) e é crucial para a colaboração, pois permite que os Colaboradores sejam associados aos projetos em que trabalharão.

**Padrões:**
*   **Backend:** A lógica de negócio será implementada no `ProjectService`, com endpoints no `ProjectController`. A segurança será garantida com `@PreAuthorize` para permitir que apenas o `PROJECT_MANAGER` proprietário do projeto ou um `ADMIN` possa gerenciar membros.
*   **Frontend:** A interface de gerenciamento de membros será uma nova seção dentro da página de detalhes do projeto.
*   **Dados:** A associação entre usuários e projetos será armazenada na tabela `project_members`.

**Declaração da História:** Como um Gerente de Projeto, eu quero adicionar e remover Colaboradores dos meus projetos, para que eu possa montar e gerenciar a equipe que trabalhará em cada projeto.

**Critérios de Aceitação:**
1.  O Gerente de Projeto deve ter acesso a uma interface para visualizar os membros de seus projetos.
2.  O Gerente de Projeto deve ser capaz de adicionar Colaboradores existentes no sistema aos seus projetos.
3.  O Gerente de Projeto deve ser capaz de remover Colaboradores de seus projetos.
4.  O sistema deve garantir que apenas usuários com perfil de Colaborador possam ser adicionados como Colaboradores a um projeto.
5.  O sistema deve registrar as adições e remoções de membros da equipe de um projeto no histórico de atividades.
6.  O comportamento da API/lógica de backend para esta funcionalidade pode ser verificado localmente.

**Notas de Desenvolvimento:**

*   **Insights da História Anterior**: A história 1.3 introduziu a entidade `Project`. Esta história irá popular a tabela de associação `project_members`.
*   **Modelos de Dados**:
    *   Utilizará a tabela `project_members` para criar e remover associações entre `projects` e `users`.
        *   [Fonte: architecture/5-modelagem-de-dados.md]
*   **Especificações da API**:
    *   `POST /api/v1/projects/{projectId}/members`: Adiciona um usuário a um projeto.
    *   `DELETE /api/v1/projects/{projectId}/members/{userId}`: Remove um membro de um projeto.
    *   Ambos os endpoints devem ser protegidos para `ADMIN` ou `PROJECT_MANAGER` proprietário.
        *   [Fonte: architecture/8-especificao-da-api-restful.md#8.3-membros-do-projeto-projectsprojectidmembers]
*   **Localização de Arquivos**:
    *   **Backend**: `taskflow-backend/src/main/java/com/taskflow/project/` (adicionar novos métodos ao `ProjectController` e `ProjectService`).
    *   **Frontend**: `taskflow-frontend/src/features/projects/components/` (criar um novo componente `ProjectMembers.tsx`).
        *   [Fonte: architecture/source-tree.md]
*   **Restrições Técnicas**:
    *   A lógica de negócio no backend deve verificar se o usuário que está sendo adicionado possui o papel `COLLABORATOR`.
    *   A autorização deve garantir que apenas o proprietário do projeto possa modificar a equipe.

**Tarefas / Subtarefas:**

1.  **Backend**
    *   [x] Adicionar métodos `addMember` e `removeMember` ao `ProjectService`.
    *   [x] Adicionar os endpoints `POST /projects/{projectId}/members` e `DELETE /projects/{projectId}/members/{userId}` ao `ProjectController`.
    *   [x] Proteger os novos endpoints com `@PreAuthorize` para verificar a propriedade do projeto.
    *   [x] Implementar a lógica para garantir que apenas `COLLABORATOR`s possam ser adicionados.
    *   [x] Escrever testes de integração para os novos endpoints.
2.  **Frontend**
    *   [x] Criar o componente `ProjectMembers` para exibir e gerenciar os membros do projeto.
    *   [x] Implementar a funcionalidade de adicionar membros (ex: um campo de busca e um botão "Adicionar").
    *   [x] Implementar a funcionalidade de remover membros (ex: um botão "Remover" ao lado de cada membro).
    *   [x] Integrar o componente com os novos endpoints da API.
    *   [x] Escrever testes de componentes para `ProjectMembers`.

## QA Results

### Review Date: 2025-11-06

### Reviewed By: Quinn (Test Architect)

### Gate Status

Gate: CONCERNS → docs/qa/gates/1.4-team-management.yml

